{"version":3,"sources":["__tests__/project/ProjectUtils-test.js"],"names":["jest","mock","mockfs","require","slugify","packageJson","name","version","expJson","sdkVersion","slug","appJson","expo","packageJsonWithExp","exp","expJsonWithNodeModulesPath","nodeModulesPath","setupDirs","fs","packageJsonString","JSON","stringify","__configureFs","describe","beforeEach","async","afterEach","restore","it","pkg","await","ProjectUtils","readConfigJsonAsync","expect","toEqual"],"mappings":"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","file":"../../../__tests__/project/ProjectUtils-test.js","sourcesContent":["import * as ProjectUtils from '../../project/ProjectUtils';\n\njest.mock('analytics-node');\njest.mock('fs');\n\nconst mockfs = require('mock-fs');\nconst slugify = require('slugify');\n\nconst packageJson = {\n  name: 'testing123',\n  version: '0.5.0',\n};\n\n// these are intentionally different from package.json -- easy way to test fallbacks\nconst expJson = {\n  sdkVersion: '12.0.0',\n  name: 'My New Project',\n  slug: 'my-new-project',\n  version: '1.0.0',\n};\n\nconst appJson = {\n  expo: {\n    sdkVersion: '12.0.0',\n  },\n};\n\nconst packageJsonWithExp = {\n  name: 'testing456',\n  version: '0.7.0',\n  exp: expJson,\n};\n\nconst expJsonWithNodeModulesPath = {\n  sdkVersion: '12.0.0',\n  name: 'My New Project',\n  slug: 'my-new-project',\n  version: '1.0.0',\n  nodeModulesPath: 'node-modules-path',\n};\n\nfunction setupDirs() {\n  const fs = require('fs');\n\n  const packageJsonString = JSON.stringify(packageJson, null, 2);\n  fs.__configureFs({\n    '/home/mocky/appjson/package.json': packageJsonString,\n    '/home/mocky/appjson/app.json': JSON.stringify(appJson, null, 2),\n    '/home/mocky/expjson/package.json': packageJsonString,\n    '/home/mocky/expjson/exp.json': JSON.stringify(expJson, null, 2),\n    '/home/mocky/nojson/package.json': JSON.stringify(packageJsonWithExp, null, 2),\n    '/home/mocky/expjson-with-node-modules/exp.json': JSON.stringify(\n      expJsonWithNodeModulesPath,\n      null,\n      2\n    ),\n    '/home/mocky/expjson-with-node-modules/node-modules-path/package.json': packageJsonString,\n  });\n}\n\ndescribe('readConfigJsonAsync', () => {\n  beforeEach(async () => {\n    setupDirs();\n  });\n\n  afterEach(() => {\n    mockfs.restore();\n  });\n\n  it('parses a project root with a normal exp.json', async () => {\n    const { exp, pkg } = await ProjectUtils.readConfigJsonAsync('/home/mocky/expjson');\n\n    expect(exp).toEqual(expJson);\n    expect(pkg).toEqual(packageJson);\n  });\n\n  it('parses a project root with only a package.json', async () => {\n    const { exp, pkg } = await ProjectUtils.readConfigJsonAsync('/home/mocky/nojson');\n\n    expect(exp).toEqual(expJson);\n    expect(pkg).toEqual(packageJsonWithExp);\n  });\n\n  it('parses a project root with an app.json relying on package.json fallbacks', async () => {\n    const { exp, pkg } = await ProjectUtils.readConfigJsonAsync('/home/mocky/appjson');\n\n    expect(exp.sdkVersion).toEqual(appJson.expo.sdkVersion);\n    expect(exp.version).toEqual(packageJson.version);\n    expect(exp.name).toEqual(packageJson.name);\n    expect(exp.slug).toEqual(slugify(packageJson.name));\n\n    expect(pkg).toEqual(packageJson);\n  });\n\n  it('reads package.json at nodeModulesPath', async () => {\n    const { exp, pkg } = await ProjectUtils.readConfigJsonAsync(\n      '/home/mocky/expjson-with-node-modules'\n    );\n\n    expect(exp).toEqual(expJsonWithNodeModulesPath);\n    expect(pkg).toEqual(packageJson);\n  });\n});\n"],"sourceRoot":"/xdl@53.7.2/src"}